{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Question 3\"\nauthor: \"Addison van den Hoeven, Mona Philippon, Deepwinder Singh\"\ndate: \"October 18, 2017\"\noutput:\n  prettydoc::html_pretty:\n  theme: cayman\n  highlight: github\n---\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = TRUE)\n```\n\n### Question at hand\n\nSuppose that Joe draws $k$ balls from an urn containing $n$ red balls and $n$ green balls, \\emph{without replacing the balls after they are drawn}. Similarly, Mary draws $k$ balls from an urn containing $m$ red balls and $m$ green balls, without replacing the balls after they are drawn. \n\nWe want to compute the probability that Joe and Mary will draw the the same number of red balls.\n\n\n### Finding the probability of either Joe or Mary\n\nLet $x$ be the number of red balls drawn/successes, $k$ be the total number of balls drawn, and $2n$, $n_{r}$, and $n_{g}$ be the number of balls total, the number of red balls, and the number of green balls in the urn respectively.\n\nIt can be said that an inividual outcome $x$ can hold values $\\Omega = \\{0,1, ... , k\\}$ and the probability of an individual outcome $x$ for $k=1$ is ${k\\choose x} \\cdot (P_{red})^x \\cdot (P_{green})^{k-x}$ where $P_{red} = \\frac{n_{r}}{(n_{r} + n_{g})}$ and $P_{green} = \\frac{n_{g}}{(n_{r} + n_{g})}$.\n\nGeneralizing this for $k = \\{1,2, ..., n\\}$ gives us the following: \n\n$P_{X}(X=x) = {k\\choose x} \\cdot \\displaystyle\\prod_{i=0}^{x-1}(\\frac{n_{r} - i}{n_{r} - i + n_{g}}) \\cdot \\displaystyle\\prod_{i=0}^{k-x-1} (\\frac{n_{g}-1}{n_{r} - x + n_{g} - i})$\n\nThus, our procedure is as follows for calculating the probabilities for Joe \\emph{or} Mary:\n\n* Find the probability of a single occurence of an event.\n* Calculate its product.\n* Weight the product according to how often the event occurs. In this case this value follows $\\frac{{k\\choose x}}{2^k}$.\n\nNote: the variable $n$ can be thought of as changed to $m$ when calculating probabilities for Mary.\n\nBelow is the function used to find the probability of Joe or Mary.\n\n```{r}\n\n# Inputs are succeses (x), number of balls (n), and draws (k)\nfind_prob <- function(successes, number_balls, draws) {\n  \n  #variables for both red and green balls\n  reds <- number_balls\n  greens <- number_balls\n  \n  #index for appending in R (it seems there is no .append() function in R like in python...)\n  index <- 1\n  \n  #variable to track how many reds have been drawn so far\n  red_success <- 0\n  \n  #vector to track the products\n  product_vector <- c()\n  \n  # This loop runs k times. \n  for(i in 1:draws) {\n    if(red_success < successes) {\n      product_vector[i] <- reds/(reds + greens)\n      red_success <- red_success + 1\n      reds <- reds - 1\n      if(reds == 0) {\n        print(\"No more reds, result should be 0.\")\n      }\n    }else {\n      product_vector[i] <- greens/(reds + greens)\n      greens <- greens - 1\n      if(greens == 0) {\n        print(\"No more greens, result should be 0.\")\n      }\n    }\n  }\n  #multiply the product of the occurences by the number of possible events that create the product.\n  prob <- prod(product_vector)*choose(draws,successes)\n  return(prob)\n}\n\n```\n\n### Calculating the probability of Joe and Mary\n\nTo calculate the probability of Joe and Mary drawing the same number of red balls we must calculate $P_{XY}(X=Y)$ or $P_{XY}(X=r, Y=r) = P_{X}(X=r) \\cdot P_{Y}(Y=r|X=r)$ and since the events are independant as neither individual drawing from their own urn affects the other urn, we can assume the following: \n\n$P_{XY}(X=r, Y=r) = P_{x}(X=r) \\cdot P_{Y}(Y=r)$\n\nThis equation is now quite simple to calculate. In the discrete setting given $P_{XY}(X=r, Y=r)$ is simply:\n\n$P_{XY}(X=r, Y=r) = \\sum\\limits_{i=0}^k P_{x}(X=i) \\cdot P_{Y}(Y=i)$\n\nBelow is the function that utilizes the above function and logic along with the equation directly above to find the probaility of Joe and Mary taking the same value.\n\n```{r}\n\nprobability_joe_and_mary <- function(n, m, k) {\n  p_joe_and_mary <- 0\n  for(i in 0:k) {\n    p_joe_and_mary <- p_joe_and_mary + find_prob(successes=i, number_balls=n, draws=k)*find_prob(successes=i, number_balls=m, draws=k)\n  }\n  return(p_joe_and_mary)\n}\n```\n\n#### b) Testing the function at varying values\n\n$n = 20$, $m = 30$, $k = 1$\n\n```{r}\n\nprobability_joe_and_mary(n=20, m=30, k=1)\n\n```\n\n$n = 20$, $m = 30$, $k = 2$\n\n```{r}\n\nprobability_joe_and_mary(n=20, m=30, k=2)\n\n```\n\n$n = 200$, $m = 300$, $k = 2$\n\n```{r}\n\nprobability_joe_and_mary(n=200, m=300, k=2)\n\n```\n\n$n = 2000$, $m = 3000$, $k = 2$\n\n```{r}\n\nprobability_joe_and_mary(n=2000, m=3000, k=2)\n\n```\n\n$n = 50$, $m = 60$, $k = 17$\n\n```{r}\n\nprobability_joe_and_mary(n=50, m=60, k=17)\n\n```\n\n#### c) Comments on the results\n\nIt seems as though as $k$ increases, the probabilities decrease. This makes sense as as $k$ increase, so does the number of possible occurences and the number of possible paths to each occurence (naturally this doesn't apply to all reds or all greens). On my end, computation time increases drastically with $k$ as I have chosen to solve the problem algorithmictly rather than purely matheatically.\n\n#### d) Try the function you wrote above with n = 600, m = 500, and k = 400. You should see a result of NaN.\n\nIn the case of my solution, I am able to get a numerical result for $n = 600$, $m = 500$, and $k = 400$. This is because rather than solving my problem using combinatorics result in equations in the form of:\n\n$P_{X}(X=x) =  \\frac{{n\\choose x}{m\\choose n + m - x}}{{n+m\\choose k}}$\n\nI solved the problem using loops and much smaller numbers.\n\nCalculation for $n = 600$, $m = 500$, and $k = 400$\n\n```{r}\nprobability_joe_and_mary(n=600, m=500, k=400)\n```\n\nAttempting to use the function for $n = 6000$, $m = 5000$, and $k = 4000$ takes over 5 minutes and yields NaN.\n\nThus, we must transform:\n\n$P_{X}(X=x) = {k\\choose x} \\cdot \\displaystyle\\prod_{i=0}^{x-1}(\\frac{n_{r} - i}{n_{r} - i + n_{g}}) \\cdot \\displaystyle\\prod_{i=0}^{k-x-1} (\\frac{n_{g}-1}{n_{r} - x + n_{g} - i})$\n\ninto\n\n$\\ln P_{X}(X=x) = \\ln({k\\choose x} \\cdot \\displaystyle\\prod_{i=0}^{x-1}(\\frac{n_{r} - i}{n_{r} - i + n_{g}}) \\cdot \\displaystyle\\prod_{i=0}^{k-x-1} (\\frac{n_{g}-1}{n_{r} - x + n_{g} - i}))$\n\n$\\ln P_{X}(X=x) = \\ln {k\\choose x} + \\ln(\\displaystyle\\prod_{i=0}^{x-1}(\\frac{n_{r} - i}{n_{r} - i + n_{g}})) + \\ln(\\displaystyle\\prod_{i=0}^{k-x-1} (\\frac{n_{g}-1}{n_{r} - x + n_{g} - i}))$\n\n$\\ln P_{X}(X=x) = \\ln {k\\choose x} + (\\displaystyle\\sum_{i=0}^{x-1}\\ln(\\frac{n_{r} - i}{n_{r} - i + n_{g}})) + (\\displaystyle\\sum_{i=0}^{k-x-1} \\ln(\\frac{n_{g}-1}{n_{r} - x + n_{g} - i}))$\n\n```{r}\n\n# Inputs are succeses (x), number of balls (n), and draws (k)\nfind_prob_log <- function(successes, number_balls, draws) {\n  \n  #variables for both red and green balls\n  reds <- number_balls\n  greens <- number_balls\n  \n  #index for appending in R (it seems there is no .append() function in R like in python...)\n  index <- 1\n  \n  #variable to track how many reds have been drawn so far\n  red_success <- 0\n  \n  #vector to track the products\n  product_vector <- c()\n  \n  # This loop runs k times. \n  for(i in 1:draws) {\n    if(red_success < successes) {\n      product_vector[i] <- log(reds) - log(reds + greens)\n      red_success <- red_success + 1\n      reds <- reds - 1\n      if(reds == 0) {\n        print(\"No more reds, result should be 0.\")\n      }\n    }else {\n      product_vector[i] <- log(greens) - log(reds + greens)\n      greens <- greens - 1\n      if(greens == 0) {\n        print(\"No more greens, result should be 0.\")\n      }\n    }\n  }\n  #multiply the product of the occurences by the number of possible events that create the product.\n  prob <- sum(product_vector) + (lfactorial(draws) - lfactorial(successes) - lfactorial(draws-successes))\n  return(prob)\n}\n\n\nprobability_joe_and_mary_log <- function(n, m, k) {\n  p_joe_and_mary <- 0\n  for(i in 0:k) {\n    p_joe_and_mary <- p_joe_and_mary + exp(find_prob_log(successes=i, number_balls=n, draws=k) + find_prob_log(successes=i, number_balls=m, draws=k))\n  }\n  return(p_joe_and_mary)\n}\n\n\n```\n\nTesting the find_prob_log function:\n\n\n```{r}\n\nfor(i in 0:2) {\n  print(\"log func\")\n  print(find_prob(successes=i, number_balls=20, draws=2))\n  print(\"reg func\")\n  print(exp(find_prob_log(successes=i, number_balls=20, draws=2)))\n}\n\n```\n\nTesting the probability_joe_and_mary_log function:\n\n```{r}\n\nfor(i in 0:2) {\n  print(\"log func\")\n  print(probability_joe_and_mary(n=20, m=20, k=i))\n  print(\"reg func\")\n  print(probability_joe_and_mary_log(n=20, m=20, k=i))\n}\n\n```\n\nNow we know our functions return the same values. we can compute:\n\n$n = 6000$, $m = 5000$, and $k = 4000$\n\n```{r}\n\nprobability_joe_and_mary_log(n=6000,m=5000,k=4000)\n\n```",
    "created" : 1508946292336.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2897068874",
    "id" : "29A38930",
    "lastKnownWriteTime" : 1508946571,
    "last_content_update" : 1508946571911,
    "path" : "C:/Users/Addy/Desktop/Statistical Learning R/Statistical-Learning/R  and rough work/Assignment 2/Q3 markdown.Rmd",
    "project_path" : "Assignment 2/Q3 markdown.Rmd",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}